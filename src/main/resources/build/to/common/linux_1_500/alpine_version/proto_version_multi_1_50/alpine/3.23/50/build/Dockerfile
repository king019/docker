FROM registry.cn-qingdao.aliyuncs.com/king019/alpine:3.23


DKCONFIG multi_run_cmd alpine
ENV WS=/app
ENV TZ=Asia/Shanghai
ENV WS_VER=/app/ver
WORKDIR ${WS}
RUN source /etc/profile;chmod 755 /*.sh;mkdir -p ${WS}
RUN source /etc/profile;chmod 755 /*.sh;mkdir -p ${WS_VER}
RUN source /etc/profile;chmod 755 /*.sh;mkdir -p /root/.ssh
RUN source /etc/profile;chmod 755 /*.sh;mkdir -p /root/.m2/repository
RUN source /etc/profile;chmod 755 /*.sh;mkdir -p /etc/docker
RUN source /etc/profile;chmod 755 /*.sh;mkdir -p /root/.docker
RUN source /etc/profile;chmod 755 /*.sh;echo -e '{\n  "experimental": "enabled"\n}' > /config.json
RUN source /etc/profile;chmod 755 /*.sh;echo -e '{\n  "experimental": "enabled",\n  "registry-mirrors": [\n    "http://docker:5000",\n    "http://docker:5001",\n    "http://nexus:5000",\n    "http://nexus:5001",\n    "https://msb3wa7d.mirror.aliyuncs.com"\n  ],\n  "debug": true,\n  "insecure-registries": [\n    "docker:5000",\n    "docker:5001",\n    "nexus:5000",\n    "nexus:5001"\n  ]\n}' > /daemon.json
RUN source /etc/profile;chmod 755 /*.sh;echo -e '<?xml version="1.0" encoding="UTF-8"?>\n<settings xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://maven.apache.org/SETTINGS/1.0.0"\n          xsi:schemaLocation="http://maven.apache.org/SETTINGS/1.0.0 http://maven.apache.org/xsd/settings-1.0.0.xsd">\n    <pluginGroups>\n        <pluginGroup>org.apache.tomcat.maven</pluginGroup>\n    </pluginGroups>\n    <servers>\n        <server>\n            <id>nexus</id>\n            <username>admin</username>\n            <password>admin</password>\n        </server>\n    </servers>\n    <mirrors>\n        <mirror>\n            <id>nexus</id>\n            <name>nexus</name>\n            <url>http://repo.huaweicloud.com/repository/maven/</url>\n            <mirrorOf>*</mirrorOf>\n        </mirror>\n    </mirrors>\n</settings>' > /root/.m2/settings.xml
RUN source /etc/profile;chmod 755 /*.sh;echo -e "#!/bin/sh\nset -x\n\nrm -fr ~/.m2/repository" > /mvnclean.sh
RUN source /etc/profile;chmod 755 /*.sh;echo -e "-----BEGIN OPENSSH PRIVATE KEY-----\nb3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABsgAAAAdzc2gtZH\nNzAAAAgQD4AelfrarA3R1HrN5BLMWJTC7zTmosBMYCFVZzlWUH6YNs8Tg8z7a7yjejkWyy\njj6pdPzvtgopLqjC5H9rMpPOpLZfwMVNOsdj8snGyLpKH934LKhsW0eQihS0MM0GN+SBdh\nyQqLEAl0bQTZ3Zl1rLjNgbVOKCxYafAXBKz3YpTwAAABUA+WUqtywgQQI4w+E636YTUoAs\nkF8AAACBANCAc7WzmJ7/BXdZFTNGd7JBUPTKxfoI8nsZ9o7BfCtUYTHjFQfDy+B9Wp01xe\nxrmoGlxSeP5mXTI4U9Dhh9qsK2IV92tPGvg4BiP66GxIWf3e8ySnvdpFfui70Kxs6pu/HP\nfJ9q8UUDreSOwKIW9yveeUs2NnYivUBrt6duvNpxAAAAgB4pOIdQwY7F7WDJ6jhYEA4j4B\nsRkujGInROn7+qO21uxf845OlxXovNHJdWM/tZxue5M9xIrRqk4D0fB9RqKQJCR3lZCEaT\nGzBoF3plhJDJoAA2lSLWrL7x4QkdHWi3eJXsmaUciLYeOZpY1tW/yMBVQeJHVb4eeB070L\n3MtTIAAAACANFtrw7Rba8OAAAAB3NzaC1kc3MAAACBAPgB6V+tqsDdHUes3kEsxYlMLvNO\naiwExgIVVnOVZQfpg2zxODzPtrvKN6ORbLKOPql0/O+2CikuqMLkf2syk86ktl/AxU06x2\nPyycbIukof3fgsqGxbR5CKFLQwzQY35IF2HJCosQCXRtBNndmXWsuM2BtU4oLFhp8BcErP\ndilPAAAAFQD5ZSq3LCBBAjjD4TrfphNSgCyQXwAAAIEA0IBztbOYnv8Fd1kVM0Z3skFQ9M\nrF+gjyexn2jsF8K1RhMeMVB8PL4H1anTXF7GuagaXFJ4/mZdMjhT0OGH2qwrYhX3a08a+D\ngGI/robEhZ/d7zJKe92kV+6LvQrGzqm78c98n2rxRQOt5I7Aohb3K955SzY2diK9QGu3p2\n682nEAAACAHik4h1DBjsXtYMnqOFgQDiPgGxGS6MYidE6fv6o7bW7F/zjk6XFei80cl1Yz\n+1nG57kz3EitGqTgPR8H1GopAkJHeVkIRpMbMGgXemWEkMmgADaVItasvvHhCR0daLd4le\nyZpRyIth45mljW1b/IwFVB4kdVvh54HTvQvcy1MgAAAAAULwXr3lPyQyDKge30Kdqewh/q\nAWUAAAAjcm9vdEBhbHBpbmUtamRrLTE3LTVjODc0OThiZjYtNHA0cmwBAgMEBQYH\n-----END OPENSSH PRIVATE KEY-----" > /id_dsa
RUN source /etc/profile;chmod 755 /*.sh;echo -e "ssh-dss AAAAB3NzaC1kc3MAAACBAPgB6V+tqsDdHUes3kEsxYlMLvNOaiwExgIVVnOVZQfpg2zxODzPtrvKN6ORbLKOPql0/O+2CikuqMLkf2syk86ktl/AxU06x2PyycbIukof3fgsqGxbR5CKFLQwzQY35IF2HJCosQCXRtBNndmXWsuM2BtU4oLFhp8BcErPdilPAAAAFQD5ZSq3LCBBAjjD4TrfphNSgCyQXwAAAIEA0IBztbOYnv8Fd1kVM0Z3skFQ9MrF+gjyexn2jsF8K1RhMeMVB8PL4H1anTXF7GuagaXFJ4/mZdMjhT0OGH2qwrYhX3a08a+DgGI/robEhZ/d7zJKe92kV+6LvQrGzqm78c98n2rxRQOt5I7Aohb3K955SzY2diK9QGu3p2682nEAAACAHik4h1DBjsXtYMnqOFgQDiPgGxGS6MYidE6fv6o7bW7F/zjk6XFei80cl1Yz+1nG57kz3EitGqTgPR8H1GopAkJHeVkIRpMbMGgXemWEkMmgADaVItasvvHhCR0daLd4leyZpRyIth45mljW1b/IwFVB4kdVvh54HTvQvcy1MgA= root@alpine-jdk-17-5c87498bf6-4p4rl" > /id_dsa.pub
RUN source /etc/profile;chmod 755 /*.sh;echo -e "-----BEGIN OPENSSH PRIVATE KEY-----\nb3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAaAAAABNlY2RzYS\n1zaGEyLW5pc3RwMjU2AAAACG5pc3RwMjU2AAAAQQTkQnjgk7im9LUvjOy3pjqCveFsHbOq\nE58SHNlHJHOw+rKs/taOMUSGeUjyromX8N7AsZNocy7A+jg+4PANzxfWAAAAwKQ9C56kPQ\nueAAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBORCeOCTuKb0tS+M\n7LemOoK94Wwds6oTnxIc2Uckc7D6sqz+1o4xRIZ5SPKuiZfw3sCxk2hzLsD6OD7g8A3PF9\nYAAAAgZ4mKGXOtp8F9Q+zIWknxsEcVSkXaTDBgfXCopqQRKJ0AAAAjcm9vdEBhbHBpbmUt\namRrLTE3LTVjODc0OThiZjYtNHA0cmwBAgMEBQ==\n-----END OPENSSH PRIVATE KEY-----" > /id_ecdsa
RUN source /etc/profile;chmod 755 /*.sh;echo -e "ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBORCeOCTuKb0tS+M7LemOoK94Wwds6oTnxIc2Uckc7D6sqz+1o4xRIZ5SPKuiZfw3sCxk2hzLsD6OD7g8A3PF9Y= root@alpine-jdk-17-5c87498bf6-4p4rl" > /id_ecdsa.pub
RUN source /etc/profile;chmod 755 /*.sh;echo -e "-----BEGIN OPENSSH PRIVATE KEY-----\nb3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW\nQyNTUxOQAAACA1IhP806yq8r69X4S3uZQ8Ewgzd8SevYMhiHOoF99Z3wAAAKiGWZ6phlme\nqQAAAAtzc2gtZWQyNTUxOQAAACA1IhP806yq8r69X4S3uZQ8Ewgzd8SevYMhiHOoF99Z3w\nAAAEDCUfuDX116hGctoGlMslCDuxAsGwqNkgMityHcW887rTUiE/zTrKryvr1fhLe5lDwT\nCDN3xJ69gyGIc6gX31nfAAAAI3Jvb3RAYWxwaW5lLWpkay0xNy01Yzg3NDk4YmY2LTRwNH\nJsAQI=\n-----END OPENSSH PRIVATE KEY-----" > /id_ed25519
RUN source /etc/profile;chmod 755 /*.sh;echo -e "ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIDUiE/zTrKryvr1fhLe5lDwTCDN3xJ69gyGIc6gX31nf root@alpine-jdk-17-5c87498bf6-4p4rl" > /id_ed25519.pub
RUN source /etc/profile;chmod 755 /*.sh;echo -e "-----BEGIN OPENSSH PRIVATE KEY-----\n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\nBAUGBw==\n-----END OPENSSH PRIVATE KEY-----" > /id_rsa
RUN source /etc/profile;chmod 755 /*.sh;echo -e "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCouCXhExqSi91TzAVVziP57kTPvUIqjggB0yF0Eq3L+ZWCnCDfU97Sx+xFCpEv98W7I0gwqssIEYUkUytztpzMKoujA7SFDqsNat31tYuuyAAb/LbjudPwmf29FFDlij7tQYufE+Fz/zX66mT9XpsDmTCxw156gLfaG059h4WAUPp0YjIp/vwh7rgsU8WYUuBevnxiMHXIhCkg6H3sW7bLYtICp2KSpN8mZugS20lO6gJ82HJ0lAOyagUHCK1aATE8EKbBidW3ym63SA/CznhePSf48MmNpHw8d76oeOj+fL0JIW5MsSAuA7hkIOPVqNiyykH+JFYBU1bCbWIVo0rTuzoRAXoWtRiNWhX0SeAP7lZJUDkcKfVmwa8ESfniaPeeK5pfSA6n4GkkaRNTePDLxVOeLdwAkA9qP/4ndEZDn4l5j4i1SGnhehgAchiREIaFQ6vi1003bZ/ywdkzOODbcH387LPc7yPcNhKSlkkgSC55zQo4bJhGvfsblpZXfO0= root@alpine-jdk-17-5c87498bf6-4p4rl" > /id_rsa.pub
RUN source /etc/profile;chmod 755 /*.sh;echo -e "#!/bin/bash\nset -x\nsh /trans_repo.sh\nsh /trans_maven.sh" > /trans.sh
RUN source /etc/profile;chmod 755 /*.sh;echo -e "#!/bin/bash\nset -x\nsed -i 's/repo.huaweicloud.com/nexus:8081/g' /root/.m2/settings.xml" > /trans_maven.sh
RUN source /etc/profile;chmod 755 /*.sh;echo -e "#!/bin/bash\nset -x\nsh /trans_repo_bak.sh\nsh /trans_repo_nexus.sh" > /trans_repo.sh
RUN source /etc/profile;chmod 755 /*.sh;echo -e "#!/bin/bash\nset -x\n\nsed -i 's/http/https/g' /etc/apk/repositories\nsed -i 's/mirrors.aliyun.com/dl-cdn.alpinelinux.org/g' /etc/apk/repositories" > /trans_repo_bak.sh
RUN source /etc/profile;chmod 755 /*.sh;echo -e "#!/bin/bash\nset -x\nsed -i 's/https/http/g' /etc/apk/repositories\nsed -i 's/dl-cdn.alpinelinux.org/nexus:8081\/repository\/alpine/g' /etc/apk/repositories" > /trans_repo_nexus.sh
RUN source /etc/profile;chmod 755 /*.sh;echo -e "#!/bin/sh\nset -x\n" > /dkrun.sh
RUN source /etc/profile;chmod 755 /*.sh;echo -e "#!/bin/sh\nset -x\nsource /etc/profile;echo ''\nchmod -R 777 /*.sh\n/multi.sh\ntail -f /docker.sh" > /docker.sh
RUN source /etc/profile;chmod 755 /*.sh;echo -e "#!/bin/sh\nset -x\n" > /extra.sh
RUN source /etc/profile;chmod 755 /*.sh;echo -e "#!/bin/sh\nset -x\n/sshd.sh\n/dkrun.sh\n/extra.sh" > /multi.sh
RUN source /etc/profile;chmod 755 /*.sh;echo -e "#!/bin/sh\nset -x\n#/usr/sbin/sshd" > /sshd.sh
RUN source /etc/profile;chmod 755 /*.sh;mkdir -p /root/.docker;cp /config.json /root/.docker/config.json
RUN source /etc/profile;chmod 755 /*.sh;mkdir -p /etc/docker;cp /daemon.json /etc/docker/daemon.json
DKCONFIG multi_run_cmd settings
DKCONFIG multi_run_cmd go_proxy
RUN source /etc/profile;chmod 755 /*.sh;echo 'source /etc/profile' >> /root/.bashrc



MAINTAINER king019

RUN source /etc/profile;chmod 755 /*.sh;source /etc/profile
CMD /docker.sh
